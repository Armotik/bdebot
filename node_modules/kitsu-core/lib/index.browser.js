!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).kitsuCore={})}(this,(function(t){"use strict";function e(t){return"object"==typeof t&&null!==t&&(Array.isArray(t)?t.map(t=>e(t)):t.attributes&&t.attributes.constructor===Object&&(Object.keys(t.attributes).forEach(e=>{t[e]=t.attributes[e]}),delete t.attributes)),t}function r(t){if(t.response){const e=t.response.data;e&&e.errors&&(t.errors=e.errors)}throw t}function n(t,{id:e,type:n}){try{if(e&&n){const r=t.filter(t=>t.id===e&&t.type===n)[0]||{id:e,type:n};return Object.assign({},r)}return{}}catch(t){r(t)}}function a({id:t,type:r,meta:a},i){const o=n(i,{id:t,type:r});return o.relationships&&s(o,i),a&&(o.meta=a),e(o)}function i(t,e,r){t[r]=[];for(const n of t.relationships[r].data)t[r].push(a(n,e))}function o(t,e,r){t[r]=a(t.relationships[r].data,e),delete t[r].relationships}function s(t,e){const{relationships:r}=t;let n=!1;for(const a in r)r[a].data&&Array.isArray(r[a].data)?(i(t,e,a),n=!0):r[a].data&&(o(t,e,a),n=!0);return n&&delete t.relationships,t}function c(t,e=null){const r=[];for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&r.push((n=t[i],a=e?"".concat(e,"[").concat(i,"]"):i,null!==n&&"object"==typeof n?c(n,a):encodeURIComponent(a)+"="+encodeURIComponent(n)));var n,a;return r.join("&")}function u(t,e,r,n,a){return n.relationships||(n.relationships={}),t.type||(t.type=e),n.relationships[r]={data:Object.assign(t)},n}function l(t,e,r,n,a){return n.relationships||(n.relationships={}),n.relationships[r]={data:t.map(({id:t,type:r})=>({id:t,type:r||e}))},n}function d(t,e,r){return r.attributes||(r.attributes={}),r.attributes[e]=t,r}function p(t){return Object.prototype.hasOwnProperty.call(t,"id")}t.camel=t=>t.replace(/[-_][a-z\u00E0-\u00F6\u00F8-\u00FE]/g,t=>t.slice(1).toUpperCase()),t.deattribute=e,t.deserialise=function(t){if(t)return t.data&&t.data.constructor===Array?t=function(t){for(let r of t.data)t.included&&(r=s(r,t.included)),r.attributes&&(r=e(r)),t.data[t.data.indexOf(r)]=r;return t}(t):t.included&&(t.data=s(t.data,t.included)),delete t.included,t.data&&t.data.attributes&&(t.data=e(t.data)),t},t.error=r,t.filterIncludes=n,t.kebab=t=>t.charAt(0).toLowerCase()+t.slice(1).replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,t=>"-"+t.toLowerCase()),t.linkRelationships=s,t.query=c,t.serialise=function(t,e={},n="POST"){try{if(null===e||Array.isArray(e)&&0===e.length)return{data:e};const r=this.plural?this.plural(this.camel(t)):this.camel(t);let a={type:r};!function(t,e,r){if(t.constructor!==Object||0===Object.keys(t).length)throw new Error("".concat(e," requires a JSON object body"));if("POST"!==e&&!t.id)throw new Error("".concat(e," requires an ID for the ").concat(r," type"))}(e,n,r),e.id&&(a.id=String(e.id));for(const t in e){const r=e[t],n=this.plural?this.plural(this.camel(t)):this.camel(t);null!==r&&r.constructor===Object&&p(r)?a=u(r,n,t,a):null!==r&&Array.isArray(r)&&r.length>0&&p(r[0])?a=l(r,n,t,a):"id"!==t&&"type"!==t&&(a=d(r,t,a))}return{data:a}}catch(t){throw r(t)}},t.snake=t=>t.charAt(0).toLowerCase()+t.slice(1).replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,t=>"_"+t.toLowerCase()),Object.defineProperty(t,"__esModule",{value:!0})}));
